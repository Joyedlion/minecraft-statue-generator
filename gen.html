<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MC Statue Generator - Stage 1</title>
<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
<style>
/* --- BASE --- */
* { margin:0; padding:0; box-sizing:border-box; font-family:'Roboto', sans-serif;}
body { background:#111; color:#EEE; overflow:hidden; }
header { position:sticky; top:0; background:#111; z-index:100; box-shadow:0 4px 15px rgba(0,0,0,0.5);}
nav { max-width:1200px; margin:0 auto; display:flex; justify-content:space-between; align-items:center; padding:15px 30px;}
nav h1 { font-size:1.8em; color:#4A90E2;}
nav ul { display:flex; list-style:none;}
nav ul li { margin-left:25px; cursor:pointer; font-weight:500; transition: color 0.3s;}
nav ul li:hover { color:#4A90E2; }

/* --- GENERATOR PANEL --- */
#generatorOverlay {
  position:absolute; top:10px; left:10px; z-index:10; color:white;
  background:rgba(0,0,0,0.5); padding:15px; border-radius:10px;
}
#generatorOverlay input, #generatorOverlay button {
  margin:5px 0; padding:10px 20px; border:none; border-radius:5px; cursor:pointer;
}
#generatorOverlay button { background:#4A90E2; color:#FFF; transition:0.3s; }
#generatorOverlay button:hover { background:#7ED321; transform:scale(1.05); }

/* --- RESPONSIVE --- */
@media(max-width:768px){
  #generatorOverlay { width:90%; left:5%; top:auto; bottom:10px; display:flex; flex-direction:column; }
}
</style>
</head>
<body>

<!-- Header -->
<header>
<nav>
<h1>MC Statue Generator</h1>
<ul>
<li>Home</li>
<li>Generator</li>
<li>About</li>
<li>Contact</li>
</ul>
</nav>
</header>

<!-- Generator Overlay -->
<div id="generatorOverlay">
  <input type="file" id="skinInput" accept=".png">
  <button id="screenshotBtn">Screenshot</button>
  <p>Rotate: Drag | Zoom: Scroll</p>
</div>

<!-- Three.js Renderer -->
<canvas id="sceneCanvas"></canvas>

<script src="https://cdn.jsdelivr.net/npm/three@0.158.0/build/three.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/three@0.158.0/examples/js/controls/OrbitControls.js"></script>
<script src="https://cdn.jsdelivr.net/npm/file-saver@2.0.5/dist/FileSaver.min.js"></script>
<script>
// --- Scene Setup ---
let scene = new THREE.Scene();
scene.background = new THREE.Color(0x111111);
let camera = new THREE.PerspectiveCamera(45, window.innerWidth/window.innerHeight, 0.1, 1000);
camera.position.set(4,5,7);

let renderer = new THREE.WebGLRenderer({canvas:document.getElementById('sceneCanvas'), antialias:true});
renderer.setSize(window.innerWidth, window.innerHeight);

// Controls
let controls = new THREE.OrbitControls(camera, renderer.domElement);
controls.enableDamping = true;

// Lighting
let light = new THREE.DirectionalLight(0xffffff,1);
light.position.set(5,10,5);
scene.add(light);
scene.add(new THREE.AmbientLight(0xffffff,0.3));

// Ground grid
let grid = new THREE.GridHelper(20,20);
scene.add(grid);

// --- Player Model Group ---
let playerGroup = new THREE.Group();
scene.add(playerGroup);

let skinTexture = null;

// --- Load Skin ---
document.getElementById('skinInput').addEventListener('change', function(e){
  let file = e.target.files[0];
  if(!file) return;
  let reader = new FileReader();
  reader.onload = function(ev){
    let loader = new THREE.TextureLoader();
    skinTexture = loader.load(ev.target.result, () => {
      buildPlayerModel();
    });
  }
  reader.readAsDataURL(file);
});

// --- Build Minecraft Player Model ---
function buildPlayerModel(){
  playerGroup.clear();
  if(!skinTexture) return;
  
  let material = new THREE.MeshBasicMaterial({map: skinTexture});
  
  let parts = [
    {name:'Head', w:1, h:1, d:1, y:2.75},
    {name:'Body', w:1, h:1.5, d:0.5, y:1.5},
    {name:'LeftArm', w:0.5, h:1.5, d:0.5, x:-0.75, y:1.5},
    {name:'RightArm', w:0.5, h:1.5, d:0.5, x:0.75, y:1.5},
    {name:'LeftLeg', w:0.5, h:1.5, d:0.5, x:-0.25, y:0},
    {name:'RightLeg', w:0.5, h:1.5, d:0.5, x:0.25, y:0}
  ];
  
  parts.forEach(p => {
    let geom = new THREE.BoxGeometry(p.w, p.h, p.d);
    let mesh = new THREE.Mesh(geom, material);
    mesh.position.set(p.x||0, p.y, p.z||0);
    mesh.name = p.name;
    playerGroup.add(mesh);
  });
}

// --- Screenshot ---
document.getElementById('screenshotBtn').addEventListener('click', function(){
  renderer.render(scene, camera);
  renderer.domElement.toBlob(function(blob){
    saveAs(blob, 'statue.png');
  });
});

// --- Animation Loop ---
function animate(){
  requestAnimationFrame(animate);
  controls.update();
  renderer.render(scene, camera);
}
animate();

// --- Handle Resize ---
window.addEventListener('resize', () => {
  camera.aspect = window.innerWidth/window.innerHeight;
  camera.updateProjectionMatrix();
  renderer.setSize(window.innerWidth, window.innerHeight);
});
</script>

</body>
</html>